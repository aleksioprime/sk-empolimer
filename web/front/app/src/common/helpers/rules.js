// Для окончания слова с числительным
const plural = (n, one, few, many) => {
  n = Math.abs(n);
  if (n % 10 === 1 && n % 100 !== 11) return one;
  if (n % 10 >= 2 && n % 10 <= 4 && (n % 100 < 10 || n % 100 >= 20)) return few;
  return many;
};

// Правила валидации
const rules = {
  // Обязательное поле
  required: v => !!v || "Обязательное поле",

  // Минимум символов
  minLength: min => v =>
    (typeof v === "string" && v.length >= min) ||
    `Минимум ${min} ${plural(min, "символ", "символа", "символов")}`,

  // Максимум символов
  maxLength: max => v =>
    (typeof v === "string" && v.length <= max) ||
    `Максимум ${max} ${plural(max, "символ", "символа", "символов")}`,

  // Только буквы (рус/лат)
  onlyLetters: v =>
    /^[А-ЯA-Zа-яa-zёЁ\-'\s]+$/i.test(v) ||
    "Только буквы, пробелы и дефисы",

  // Только латиница, цифры, . _ -
  username: v =>
    /^[a-zA-Z0-9._-]+$/.test(v) ||
    "Допустимы только латинские буквы, цифры, точка, _ и -",

  // Email
  email: v =>
    !v || /.+@.+\..+/.test(v) || "Введите корректный email",

  // Только цифры
  digits: v =>
    !v || /^\d+$/.test(v) || "Только цифры",

  // Минимальное значение (для чисел)
  minValue: min => v =>
    !v || Number(v) >= min || `Минимум ${min}`,

  // Максимальное значение (для чисел)
  maxValue: max => v =>
    !v || Number(v) <= max || `Максимум ${max}`,

  // Значение в диапазоне
  between: (min, max) => v =>
    !v || (Number(v) >= min && Number(v) <= max) ||
    `Значение от ${min} до ${max}`,

  // Проверка совпадения с другим значением (например, повтор пароля)
  sameAs: (otherValue, msg = "Значения не совпадают") => v => v === otherValue || msg,

  // Телефон (простой)
  phone: v =>
    !v || /^(\+7|8)?[\s\-]?\(?\d{3,4}\)?[\s\-]?\d{3}[\s\-]?\d{2}[\s\-]?\d{2}$/.test(v) || "Некорректный телефон",
};

export default rules;